import pandas as pd
import numpy as np
import matplotlib.pyplot as plt

names = ["DN121_BCE_SGD", "DN121_BCE_ADAM", "DN121_BCEW_SGD", "DN121_BCEW_ADAM", "DN121_FL_SGD", 'DN121_FL_ADAM', "DN121_FLW_SGD", 'DN121_FLW_ADAM']
F1_micro = [0.4490271768698671, 0.44081192742949526, 0.27262732081734264, 0.2656357388316151, 0.4888846665399962, 0.4705651875795866, 0.2713066364483761, 0.20120992669787158]
F1_macro = [0.2648278668846007, 0.2326946951850286, 0.22631636630077964, 0.2291472284512035, 0.2709384907170984, 0.2530673559614234, 0.22802431714938082, 0.18320566950037323]
AUC_micro = [0.9113352183377941, 0.9034006962391063, 0.8521223545998147, 0.8542553915628956, 0.9098963641943403, 0.9081494410762897, 0.8818355303136352, 0.8407519434290054]
AUC_macro = [0.8645911593965809, 0.8536875379287089, 0.828547416912809, 0.827266533906942, 0.8623250954893794, 0.8608125228823897, 0.8612167845591596, 0.8141736250430217]


BCE_SGD_AUCs = [0.8014425843298391, 0.8229875560896119, 0.8365513929773339, 0.8448561674540886, 0.851237297910854, 0.8569387315011323, 0.8585984023436599, 0.8609816267259575, 0.8645700855657407, 0.8667813167389817, 0.8632341906799997, 0.8641362524819374, 0.8667884616429666, 0.8666303666965205, 0.8658883492865074, 0.8668675260324115, 0.8662872438035063, 0.8660140777471004, 0.8660549077819184]
BCE_ADAM_AUCs = [0.7615312797055331, 0.778917387736027, 0.7943789202391599, 0.8108307423526594, 0.8194652323866733, 0.8252025616100923, 0.829758708079482, 0.8304163817342982, 0.8366025227978415, 0.8383772129761262, 0.8379619778712241, 0.8441602958408619, 0.8512237689589047, 0.8541848892588337, 0.8515810226795594, 0.8512940117481022, 0.8542795878470192, 0.8545079632864714, 0.8546703175753442, 0.8550400159033065, 0.8546827799658061, 0.8545566847248941, 0.8551558319726518, 0.8540446846699116, 0.8547010798518887, 0.8545726374314687]
BCEW_SGD_AUCs = [0.7421314026480391, 0.7672440796382556, 0.8008846901153518, 0.8116010256313366, 0.8155873490601357, 0.8194553780176022, 0.8307374431909871, 0.8283195744756683, 0.8233358469170146, 0.8306860185015649, 0.8305143597192824, 0.8306355830697985, 0.8310642125985584, 0.8306500187034181, 0.8310788035774117, 0.8304224572596219, 0.8308942391708978, 0.8309075724541729]
BCEW_ADAM_AUCs = [0.6729405588442244, 0.7293350860196177, 0.749153562617895, 0.7649553203930328, 0.7646470692187456, 0.7759954701876267, 0.7821815488907291, 0.7875500563521004, 0.7905475012143984, 0.7958385910519062, 0.805405091888123, 0.802235710182087, 0.808609275477242, 0.8039208448366615, 0.8109328134460608, 0.8099052321662472, 0.8136422953491547, 0.8160276320000652, 0.8171263688937555, 0.8181997573363945, 0.8215402011027251, 0.821686382067234, 0.8223305504867462, 0.8244488267867648, 0.8245311037124476, 0.8270701542731154, 0.8271056873839909, 0.8289079697843028, 0.8250647437957778, 0.8288839178715741, 0.8289129499053177, 0.8300251399092619, 0.8296876386244763, 0.8293844814862809, 0.8296352806390715, 0.8294373761064237, 0.8294739129454406]
FL_SGD_AUCs = [0.7914100769742348, 0.8117976358017462, 0.827059833689123, 0.8347155881326495, 0.8394994470021856, 0.8410873640364112, 0.8510564083336948, 0.8537630610816472, 0.8556500671621919, 0.8601255151952384, 0.8598939751089335, 0.8630310786902592, 0.8615155016001992, 0.8641331517950942, 0.8598884093609442, 0.8630820885989767, 0.8641052535835498, 0.8646178083551416, 0.8646682299314038, 0.8646922221034526, 0.8646756228135156, 0.8641719841440111, 0.8647419845548406, 0.8642249413176785, 0.8642051155102518, 0.8641060176974402]
FL_ADAM_AUCs = [0.7431137676233274, 0.7841870796557281, 0.786648648928053, 0.7954937675645997, 0.8107562609738106, 0.8176759449345151, 0.818549935657098, 0.8249763838198029, 0.8271918426846961, 0.8301036062001033, 0.833279297625828, 0.8399184339918956, 0.8435185153122152, 0.8470975478802696, 0.8391055942190252, 0.8501284837064293, 0.8542337363089434, 0.8518514442714991, 0.8570712425082749, 0.8548025708579978, 0.8593802210625398, 0.8566777035886982, 0.8597925963848261, 0.8545577831516767, 0.8543970791610321, 0.8597827565104234, 0.860003020159823, 0.8595325006361425, 0.8597819947272246, 0.8601617477940583, 0.8597393475928009, 0.8598297935019037, 0.8596896280287868]
FLW_SGD_AUCs = [0.7364446375406647, 0.7737714120377313, 0.7951994854343816, 0.8089516630463929, 0.821358818349172, 0.8249955815453539, 0.8340646343250523, 0.8412654664528805, 0.840986217977726, 0.8500110095888643, 0.8518043840066514, 0.8552174711285022, 0.8567462293035696, 0.8561996198338897, 0.8597861253483248, 0.8625011028836405, 0.865461713665545, 0.8608782416265512, 0.8640445768823889, 0.8652057796601003, 0.8660520747222368, 0.8659617805466123, 0.8657614368306704, 0.8658880705389173, 0.8660077755129123, 0.8662810238979194, 0.8660548573645351, 0.8662441824001174, 0.8656157124620161]
FLW_ADAM_AUCs = [0.7061177963676251, 0.7438499567885821, 0.7643657389205697, 0.768308608477372, 0.7866866661610793, 0.7970949345882495, 0.8003566793997979, 0.8012457135280872, 0.8106760584499006, 0.8053783598436265, 0.8151591366464576, 0.8154524160744532, 0.8219780655594563, 0.8189679952995647, 0.8210611326331508, 0.8221238682218481, 0.8220665847351167, 0.8221610360235085, 0.8224790144532175, 0.8217542970993282, 0.8222885194109216, 0.8224546825585229, 0.8224205805949523, 0.8223709646835423]

plt.plot(F1_micro, label="micro F1 score", marker="o")
plt.plot(F1_macro, label="macro F1 score", marker="o")
plt.plot(AUC_micro, label="micro ROC_AUC score", marker="o")
plt.plot(AUC_macro, label="macro ROC_AUC score", marker="o")
plt.xticks(range(len(names)), names)
plt.title("Models scores on Test set")
plt.xticks(rotation=90)
plt.ylabel('Score')
plt.xlabel('Model')
plt.legend()
plt.show()


plt.plot(BCE_SGD_AUCs, label="DN121_BCE_SGD")
plt.plot(BCE_ADAM_AUCs, label="DN121_BCE_ADAM")
plt.plot(BCEW_SGD_AUCs, label="DN121_BCEW_SGD")
plt.plot(BCEW_ADAM_AUCs, label="DN121_BCEW_ADAM")
plt.plot(FL_SGD_AUCs, label="DN121_FL_SGD")
plt.plot(FL_ADAM_AUCs, label='DN121_FL_ADAM')
plt.plot(FLW_SGD_AUCs, label="DN121_FLW_SGD")
plt.plot(FLW_ADAM_AUCs, label='DN121_FLW_ADAM')
plt.title("macro ROG_AUC score per epoch in validation set")
plt.ylabel('ROG_AUC score')
plt.xlabel('Epoch')
plt.legend()
plt.show()

radiographic_findings = ['normal', 'calcified densities', 'nodule', 'fibrotic band', 'volume loss', 'pneumothorax',
                         'air trapping', 'bronchiectasis', 'infiltrates', 'atelectasis', 'pleural thickening',
                         'pleural effusion', 'costophrenic angle blunting', 'hilar enlargement', 'cardiomegaly',
                         'aortic elongation', 'mediastinal enlargement', 'mass', 'thoracic cage deformation',
                         'vertebral degenerative changes', 'fracture', 'hemidiaphragm elevation']

AUC_per_class = [0.8786830557413591, 0.8146068470988264, 0.7764522367482042, 0.8474109985799938, 0.9149584294445063, 0.8972737059292588, 0.8050831486497578, 0.8454501324956749, 0.887711079402796, 0.8598321706188043, 0.8765917266138472, 0.9549485134087009, 0.8886153523689626, 0.7817876615223219, 0.9248616360686763, 0.899702601765876, 0.8707896947572705, 0.8522614567270749, 0.8441916576825155, 0.8200954551500566, 0.8134108348710689, 0.9164337051207939]
F1_per_class = [0.7145912383580545, 0.2713257965056526, 0.1302816901408451, 0.20609579100145137, 0.2344139650872818, 0.0, 0.031029619181946397, 0.026578073089700997, 0.5287407738760903, 0.27311178247734136, 0.3111545988258317, 0.655575221238938, 0.29444009397024273, 0.06769230769230769, 0.5418373317729667, 0.29769033361847735, 0.3467543138866065, 0.03902439024390244, 0.3436692506459948, 0.07809110629067245, 0.2370990237099024, 0.3314500941619586]

plt.plot(AUC_per_class, label="ROC_AUC score", marker="o")
plt.plot(F1_per_class, label="F1 score", marker="o")
plt.xticks(range(len(radiographic_findings)), radiographic_findings)
plt.xticks(rotation=90)
plt.title("F1 and ROC_AUC score per class")
plt.ylabel('Score')
plt.xlabel('Class')
plt.legend()
plt.show()

print("class;auc;f1")
for i in range(len(radiographic_findings)):
    print(radiographic_findings[i]+";"+str(AUC_per_class[i])+";"+str(F1_per_class[i]))
